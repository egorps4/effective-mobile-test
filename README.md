# Тестовое задание

**Автор**: Игнатьев Егор

## Общая информация

Оба задания выполнены в рамках одного проекта с использованием **NestJS** и **TypeScript**.

## Структура проекта

### envs
Папка с переменными окружения для подключения к базе данных.

### src
Основная папка проекта.

#### Структура папки src:
- **common**: вспомогательные сервисы проекта (содержит только кастомный логгер).
- **config**: конфигурационные файлы (включает конфигурацию для базы данных).
- **interfaces**: интерфейсы.
- **migrations**: миграции для создания 1000 пользователей.
- **app.module.ts**: основной модуль приложения.
- **main.ts**: точка входа приложения.
- **api**: API.

#### Структура папки api:
- **history**: сервисы истории пользователей.
- **user**: сервисы пользователей.

## Типы файлов в проекте

- **controller**: контроллеры.
- **service**: сервисы с основной логикой.
- **repository**: логика работы с базой данных.
- **model**: описание сущностей для TypeORM.
- **entity**: представление сущностей в виде классов для более удобной работы.
- **module**: модули сервисов.

## Документация

Из-за отсутствия времени проект не был документирован с помощью Swagger, однако ниже представлена краткая документация.

### Доступные эндпоинты:

- **GET** `/api/user/all`: Получить всех пользователей.
- **POST** `/api/user`: Создать пользователя. В body запроса передаются `firstName`, `lastName`, `age`, `issues`. Возвращает объект пользователя.
- **PATCH** `/api/user/:id`: Обновить любое поле пользователя. В body запроса можно передать `firstName`, `lastName`, `age`, `issues`. Возвращает обновленный объект пользователя.
- **PATCH** `/api/user/issues/reset`: Сброс проблем пользователей (из true в false). Возвращает объект с числовым свойством, показывающим количество обновленных строк.
- **DELETE** `/api/user/:id`: "Удаление" пользователя (пометка как удаленного). Возвращает удаленного пользователя.

- **GET** `/api/history`: Возвращает историю действий с пользователем. В query параметры необходимо передать `id` пользователя. Опциональны параметры `page` и `offset` для пагинации.

## Локальный запуск проекта

1. Прописать значения в переменных окружения для подключения к PostgreSQL.
2. Выполнить команду:
   ```bash
   npm run start:dev
   
   Сущности базы данных создадутся автоматически, так как настройка synchronize у TypeORM установлена в `true`.
3. Для запуска миграций и наполнения таблицы пользователей данными, выполнить команду:
    ```bash
    npm run migration:run
